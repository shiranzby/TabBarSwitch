# TabBarSwitch (Chromium 浏览器标签栏滚轮切换工具)

这是一个基于 AutoHotkey v2 的脚本，旨在为 Chromium 内核浏览器（如 Chrome, Edge, Brave 等）提供**标签栏滚轮切换**功能。

它的最大特色是**支持后台操作**：你无需点击激活浏览器窗口，只需将鼠标悬停在浏览器顶部的标签栏区域滚动滚轮，即可快速切换标签页。这在多显示器或多窗口并排工作时极大提升了效率。

## ✨ 主要功能

*   **后台滚轮切换**：鼠标悬停在非激活窗口的标签栏上滚动，即可切换标签，无需点击激活窗口。
*   **智能防抖**：内置任务队列和防抖逻辑，防止快速滚动时的按键丢失或卡顿。
*   **无感操作**：精心优化的消息发送机制，消除标题栏闪烁，不干扰输入法状态。
*   **中键恢复**：在标签栏区域点击鼠标中键，可恢复最近关闭的标签页 (`Ctrl+Shift+T`)。
*   **广泛兼容**：支持所有基于 Chromium 内核的浏览器（Chrome, Edge, 360极速, Vivaldi 等）。

## ⚙️ 配置说明

脚本顶部包含配置区域，你可以根据需要修改 `TabBarSwitch_V2.0.ahk` 文件：

### 1. 显示/隐藏托盘图标
默认情况下，脚本运行后**不会显示**在系统托盘中（静默运行）。
如果你需要看到托盘图标（方便退出或重启），请找到脚本第 3 行：

```autohotkey
#NoTrayIcon                     ; 隐藏后台，如不需要则自行注释此行 (即: ;#NoTrayIcon)
```

将其修改为（在前面加分号）：

```autohotkey
;#NoTrayIcon                    ; 已注释，现在会显示托盘图标
```

### 2. 调整触发区域
默认只有在浏览器顶部 120 像素高度内滚动才有效。你可以修改 `TabAreaHeight` 变量：

```autohotkey
TabAreaHeight := 120        ; 顶部触发区域高度 (像素)
```

## 🚀 如何实现开机自启动

你可以选择以下任意一种方式让脚本随系统启动：

### 方法一：放入“启动”文件夹（最简单）
1.  按 `Win + R` 打开运行对话框。
2.  输入 `shell:startup` 并回车，这将打开系统的“启动”文件夹。
3.  将 `TabBarSwitch_V2.0.ahk` 的**快捷方式**（右键 -> 创建快捷方式）复制到这个文件夹中。

### 方法二：使用任务计划程序（更高级，权限更高）
如果你发现脚本在某些以管理员身份运行的程序上失效，建议使用此方法：
1.  搜索并打开“任务计划程序”。
2.  点击右侧“创建任务”。
3.  **常规**：勾选“使用最高权限运行”。
4.  **触发器**：新建 -> 开始任务选择“登录时”。
5.  **操作**：新建 -> 程序或脚本选择你的 `AutoHotkey64.exe` 路径，在“添加参数”中填入脚本的完整路径（例如 `"D:\Tools\TabBarSwitch_V2.0.ahk"`）。
6.  **条件**：取消勾选“只有在计算机使用交流电源时才启动此任务”（防止笔记本不插电不启动）。

## 📦 安装与使用

1.  确保已安装 [AutoHotkey v2](https://www.autohotkey.com/)。
2.  下载本项目中的 `TabBarSwitch_V2.0.ahk`。
3.  双击脚本文件运行即可。

## 📝 许可证

MIT License
